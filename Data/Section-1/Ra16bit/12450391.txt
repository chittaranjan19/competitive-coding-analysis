#include <stdio.h>#include <string.h>int n,m,i,j,k,kx,ky,x,y,e,b[202];char a[44],s[202],tx[5],ty[5],cur,q;bool g[405][405],can[2];int gc(char c) { return int(c=='C'); }bool gg(int i, int j) { return g[i][j^1] || g[j][i^1]; }int main() {  scanf("%s",a);  q='a'+strlen(a);  scanf("%d%d",&n,&m);  for (i=0; i<m; i++) {    scanf("%d",&x); x--;    scanf("%s",tx); kx=gc(tx[0]);    scanf("%d",&y); y--;    scanf("%s",ty); ky=gc(ty[0]);    g[x*2+kx][y*2+ky]=true;    g[y*2+1-ky][x*2+1-kx]=true;  }  scanf("%s",s);  for (k=0; k<2*n; k++) for (i=0; i<2*n; i++) for (j=0; j<2*n; j++) g[i][j]|=(g[i][k]&g[k][j]);  for (e=0; e<n; e++) b[e]=e*2+gc(a[s[e]-'a']);  for (e=0; e<n; e++) {    for (i=0; i<=e; i++) if (gg(b[e],b[i])) break;    if (i<=e) break;  }  if (e>=n) {    puts(s);    return 0;  }  for (; e>=0; e--) {    for (k=0; k<2; k++) {      can[k]=true;      for (i=0; i<=e; i++) if (gg(e*2+k,b[i])) { can[k]=false; break; }    }    if (!can[0] && !can[1]) continue;    for (s[e]++; s[e]<q && !can[gc(a[s[e]-'a'])]; s[e]++);    if (s[e]>=q) continue;    b[e]=e*2+gc(a[s[e]-'a']);    for (j=e+1; j<n; j++) {      for (k=0; k<2; k++) {        can[k]=true;        for (i=0; i<=j; i++) if (gg(j*2+k,b[i])) { can[k]=false; break; }      }      if (!can[0] && !can[1]) { puts("-1"); return 0; }      for (s[j]='a'; s[j]<q && !can[gc(a[s[j]-'a'])]; s[j]++);      if (s[j]>=q) { puts("-1"); return 0; }      b[j]=j*2+gc(a[s[j]-'a']);    }    puts(s);    return 0;  }  if (e<0) puts("-1");  return 0;}